<!doctype html>
<html>
  <head>
    <title>Socket.IO chat</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      form { background: #000; padding: 2px; position: absolute; bottom: 0; width: 100%;}
      form input { border: none; padding: 10px; width: 70%; margin-right: 1%; }
      form button { width: 29%; background: rgb(130, 224, 255); border: none; padding: 10px; }
      #messages,#usersList { list-style-type: none; margin: 0; padding: 0; height:485px; overflow-y:scroll; overflow-x: hidden;
	word-wrap: break-word;}
      #messages li,#usersList li { padding: 5px 10px; }
      #messages li:nth-child(odd) ,#usersList li:nth-child(odd){ background: #eee; }
 #chatBody { border-style:solid; border-radius:10px;
position:relative; width:400px; height:600px; margin:10px auto; overflow:hidden;}
#notify {padding:2px; padding-left:12px; color:green;}
#totalusers{padding:2px; padding-left:12px; color:green; text-align:center;}
#usersButton{height:35px; margin-top:10px;}
    </style>
  </head>
  <body>
<h3 style="text-align:center;">Welcome to my Chat App</h3>

  
<div id="chatBody">
    <div id="totalusers"><span id="total">Total 0 users connected !</span>&nbsp &nbsp<button id="usersButton" role="button">Show People online</button> </div>
    <ul id="usersList"><li>Chaitu - Online</ul>
    <ul id="messages"></ul>
    <div id="notify">User1 is typing.....</div>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>
 </div>
<script src="/socket.io/socket.io.js"></script>

<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>

$(document).ready(function(){
$('#usersList').hide();


   var socket = io();
   socket.emit('adduser', prompt("What's your name?"));   ///asking for username
  $('form').submit(function(){
    socket.emit('chat message', $('#m').val());
    $('#m').val('');
    
    return false;
  });




 socket.on('chat message', function(username,msg){

    $('#messages').append($('<li>').text(username+" : " +msg));
    $('#messages').animate({
    scrollTop: $('#messages').get(0).scrollHeight
}, 1);
  });
socket.on('connected', function(msg){

    

    $('#messages').append($('<li style="color:blue;">').text(msg));
    
  });
socket.on('totalusers', function(msg){
   
    $('#total').text(msg);
    
  });
socket.on('disconnected', function(msg){
   
    $('#messages').append($('<li style="color:blue;">').text(msg));
    
  });

var userVisability='hidden';
$('#usersButton').on('click',function(){
console.log("clicked!");
if(userVisability==='showing'){

$('#usersList').hide(500);
$('#usersButton').text("Show people Online");
userVisability='hidden';
}
else if(userVisability==='hidden'){
$('#usersList').show(500);
$('#usersButton').text("Hide people Online");
userVisability='showing';
}
});

});
</script>
  </body>
</html>
